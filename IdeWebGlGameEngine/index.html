<!doctype html>
<html lang="fr" class="h-full">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Web Game Engine IDE — Modulaire</title>

  <link rel="stylesheet" href="/src/styles/app.css">
</head>

<body class="h-full bg-bg text-slate-200">
  <div id="app" class="h-dvh flex flex-col">
    <!-- TOPBAR -->
    <header class="shrink-0 sticky top-0 z-30 bg-panel/80 backdrop-blur border-b border-white/5">
      <div class="px-3 sm:px-4 py-2 flex items-center gap-2">
        <!-- Logo -->
        <div class="flex items-center gap-2">
          <div class="size-7 rounded bg-brand/15 grid place-items-center">
            <svg viewBox="0 0 24 24" class="w-4 h-4 text-brand"><path fill="currentColor" d="M12 2l3.5 6h6l-4.8 4 2 7L12 15l-6.7 4 2-7L2.5 8h6z"/></svg>
          </div>
          <span class="font-semibold tracking-wide">Web Game Engine IDE</span>
        </div>

        <!-- Fichier -->
        <div class="relative ml-2">
          <button id="btn-file" class="px-3 py-1.5 rounded hover:bg-white/10 border border-white/10 text-sm">Fichier ▾</button>
          <div id="menu-file" class="menu absolute mt-1 w-56 bg-panel/90 border border-white/10 rounded shadow-soft z-40">
            <button id="mi-new"  class="w-full text-left px-3 py-2 hover:bg-white/10 text-sm">Nouveau projet</button>
            <label class="block px-3 py-2 hover:bg-white/10 text-sm cursor-pointer">
              Charger projet (JSON) <input id="file-load" type="file" accept="application/json" class="hidden">
            </label>
            <button id="mi-save" class="w-full text-left px-3 py-2 hover:bg-white/10 text-sm">Enregistrer projet (JSON)</button>
          </div>
        </div>

        <!-- Onglets -->
        <nav class="ml-2 flex gap-1 text-sm">
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-visual">Visual Scripting</button>
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-code">Code</button>
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-viewport">3D Viewport</button>
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-shader">Shader Editor</button>
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-audio">Audio</button>
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-animation">Animation</button>
          <button class="ide-tab px-3 py-1.5 rounded hover:bg-white/5" data-target="tab-video">Video</button>
        </nav>

        <div class="ml-auto flex items-center gap-2">
          <button id="btn-dark" class="px-3 py-1.5 rounded hover:bg-white/10 border border-white/10">Dark</button>
        </div>
      </div>
    </header>

    <!-- BODY -->
    <div class="grow min-h-0 flex">
      <!-- OUTLINER -->
      <aside id="left-pane" class="w-64 min-w-48 max-w-[40vw] bg-panel/60 border-r border-white/5 flex flex-col">
        <div class="px-3 py-2 border-b border-white/5"><h2 class="text-xs uppercase tracking-wider text-slate-400">Outliner</h2></div>
        <div class="grow min-h-0 overflow-auto p-2 space-y-3">
          <div data-role="outliner-list" class="outliner-list"></div>
        </div>
      </aside>
      <div id="div-left" class="divider-v bg-white/5"></div>

      <!-- CENTER -->
      <main id="center-pane" class="grow min-w-[40vw] bg-bg/60">
        <!-- VISUAL SCRIPTING -->
        <section id="tab-visual" class="h-full flex" data-active="true">
          <!-- Node Library -->
          <aside class="w-64 border-r border-white/5 bg-panel/50 flex flex-col">
            <div class="px-3 py-2 border-b border-white/5">
              <h3 class="text-xs uppercase tracking-wider text-slate-400">Node Library</h3>
            </div>
            <div id="node-library" class="grow overflow-auto p-2 space-y-3 text-sm"></div>
          </aside>

          <!-- Canvas -->
          <div class="grow min-w-0 relative">
            <div class="px-3 py-2 border-b border-white/5 flex items-center gap-2">
              <h3 class="text-xs uppercase tracking-wider text-slate-400">Nodes & Wires</h3>
              <span class="text-[11px] text-slate-400">Drag OUT→IN • molette=zoom • milieu=pan • Ctrl+clic câble=couper</span>
              <div class="ml-auto flex gap-2 text-xs items-center">
                <label class="flex items-center gap-2"><span>Name</span><input id="vs-name" type="text" value="MyLogic" class="bg-white/5 border border-white/10 rounded px-2 py-1"></label>
                <label class="flex items-center gap-2"><span>Assign</span><select id="vs-assign" class="bg-white/5 border border-white/10 rounded px-2 py-1"></select></label>
                <button id="btn-save-graph" class="px-2 py-1 rounded border border-white/10 hover:bg-white/10">Save Script</button>
                <div class="px-2 py-1 rounded border border-white/10 select-none">Zoom: <span id="zoom-label">100%</span></div>
              </div>
            </div>
            <div id="node-area" class="relative h-[calc(100%-40px)] overflow-hidden bg-panel/40 nodemap-cursor">
              <svg id="wires" class="absolute inset-0" width="100%" height="100%"></svg>
              <div id="viewport" class="absolute inset-0" style="transform-origin:0 0;"></div>
            </div>
          </div>
        </section>

        <!-- Autres onglets (placeholders) -->
        <section id="tab-code" class="h-full hidden"></section>
        <section id="tab-viewport" class="h-full hidden">
          <!-- Canvas WebGL utilisé par le module Viewport3D -->
          <canvas id="viewport3d" data-role="viewport3d-canvas" class="w-full h-full block"></canvas>
        </section>
        <section id="tab-shader" class="h-full hidden"></section>
        <section id="tab-audio" class="h-full hidden"></section>
        <section id="tab-animation" class="h-full hidden"></section>
        <section id="tab-video" class="h-full hidden"></section>
      </main>

      <div id="div-right" class="divider-v bg-white/5"></div>

      <!-- INSPECTOR -->
      <aside data-role="inspector" id="inspector" class="w-72 min-w-60 bg-panel/60 border-l border-white/5"></aside>
    </div>

    <div id="div-bottom" class="divider-h bg-white/5"></div>

    <!-- CONSOLE -->
    <footer id="bottom-pane" class="h-40 min-h-24 max-h-[50vh] bg-panel/60 border-t border-white/5">
      <div class="px-3 py-2 text-xs uppercase tracking-wider text-slate-400 border-b border-white/5">Console</div>
      <div id="console" class="h-[calc(100%-2rem)] overflow-auto p-2 text-[12px] font-mono whitespace-pre-wrap">
        › IDE prêt.
      </div>
    </footer>
  </div>

  <!-- Charge l'app -->
  <script type="module" src="/src/main.js"></script>
</body>
</html>
